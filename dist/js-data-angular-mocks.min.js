/*!
* js-data-angular-mocks
* @version 2.0.0 - Homepage <https://github.com/js-data/js-data-angular-mocks>
* @author Jason Dobry <jason.dobry@gmail.com>
* @copyright (c) 2014-2015 Jason Dobry <https://github.com/js-data/>
* @license MIT <https://github.com/js-data/js-data-angular-mocks/blob/master/LICENSE>
*
* @overview A mock of js-data & js-data-angular for testing purposes.
*/
!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b(function(){try{return require("sinon")}catch(a){}}(),function(){try{return require("angular")}catch(a){}}()):"function"==typeof define&&define.amd?define(["sinon","angular"],b):"object"==typeof exports?exports.jsDataAngularMocksModuleName=b(function(){try{return require("sinon")}catch(a){}}(),function(){try{return require("angular")}catch(a){}}()):a.jsDataAngularMocksModuleName=b(a.sinon,a.angular)}(this,function(__WEBPACK_EXTERNAL_MODULE_1__,__WEBPACK_EXTERNAL_MODULE_2__){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(module,exports,__webpack_require__){var _createClass=function(){function a(a,b){for(var c in b){var d=b[c];d.configurable=!0,d.value&&(d.writable=!0)}Object.defineProperties(a,b)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_classCallCheck=function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")},angular=void 0,sinon=void 0;try{sinon=__webpack_require__(1)}catch(e){}if(!sinon)try{sinon=window.sinon}catch(e){}if(!sinon)throw new Error("sinon must be loaded!");try{angular=__webpack_require__(2)}catch(e){}if(!angular)try{angular=window.angular}catch(e){}if(!angular)throw new Error("angular must be loaded!");var DS=function DS(){_classCallCheck(this,DS);var expectations=[],definitions=[],requests=[],responses=[],stubs={},asyncMethods=["create","destroy","destroyAll","find","findAll","loadRelations","reap","refresh","save","update","updateAll"],syncMethods=["bindAll","bindOne","changes","changeHistory","compute","createInstance","digest","eject","ejectAll","filter","get","getAdapter","hasChanges","inject","is","lastModified","lastSaved","link","linkAll","linkInverse","registerAdapter","previous","unlinkInverse"],Resource=function a(b,c){_classCallCheck(this,a),b.deepMixIn(this,c),this.endpoint="endpoint"in c?c.endpoint:this.name};this.$get=["DSMockUtils","DSUtils","DSErrors","$log","$rootScope",function(DSMockUtils,DSUtils,DSErrors,$log,$rootScope){var MockDSExpectation=DSMockUtils.MockDSExpectation,defaults={deserialize:function(a,b){return b.data?b.data:b}};angular.forEach(asyncMethods,function(a){stubs[a]=DSMockUtils.mockAsync(a,"DS",expectations,definitions,requests,responses),sinon.spy(stubs,a)}),angular.forEach(syncMethods,function(a){return stubs[a]=sinon.stub()}),this.defaults=defaults;var store={},_definitions={},DS={store:store,s:store,definitions:_definitions,defs:_definitions,defaults:defaults,expect:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];if(void 0===c[0])throw new Error("Resource not defined for expectation!");var e=new MockDSExpectation(a,c);return expectations.push(e),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];return e.response=b}}},flush:function(a){if(!responses.length)throw new Error("No pending DS requests to flush!");if(angular.isDefined(a))for(;a--;){if(!responses.length)throw new Error("No more pending DS requests to flush!");responses.shift()()}else for(;responses.length;)responses.shift()();$rootScope.$digest()},when:function(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;b>d;d++)c[d-1]=arguments[d];if(void 0===c[0])throw new Error("Resource not defined for definition!");var e=new MockDSExpectation(a,c);return definitions.push(e),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];e.response=b}}},verifyNoOutstandingExpectation:function(){if($rootScope.$digest(),expectations.length)throw new Error("Unsatisfied requests: "+expectations.join(", "))},utils:DSUtils,errors:DSErrors,defineResource:function defineResource(definition){var DS=this;DSUtils.isString(definition)&&(definition=definition.replace(/\s/gi,""),definition={name:definition});try{var _class,_ret=function(){Resource.prototype=DS.defaults,DS.definitions[definition.name]=new Resource(DSUtils,definition);var def=DS.definitions[definition.name];def.n=def.name,_class=def["class"]=DSUtils.pascalCase(def.name);try{"function"==typeof def.useClass?(eval("function "+_class+"() { def.useClass.call(this); }"),def[_class]=eval(_class),def[_class].prototype=function(a){function b(){}return b.prototype=a,new b}(def.useClass.prototype)):(eval("function "+_class+"() {}"),def[_class]=eval(_class))}catch(e){def[_class]=function(){}}def.methods&&DSUtils.deepMixIn(def[def["class"]].prototype,def.methods),def[_class].prototype.set=function(a,b){DSUtils.set(this,a,b);var c=DS.s[def.n].observers[this[def.idAttribute]];return c&&!DSUtils.observe.hasObjectObserve?c.deliver():DS.compute(def.n,this),this},def[_class].prototype.get=function(a){return DSUtils.get(this,a)},DS.store[def.name]={collection:[],completedQueries:{},queryData:{},pendingQueries:{},index:{},modified:{},saved:{},previousAttributes:{},observers:{},changeHistories:{},changeHistory:[],collectionModified:0};var fns=["registerAdapter","getAdapter","is"];for(key in DS)"function"==typeof DS[key]&&fns.push(key);return DSUtils.forEach(fns,function(a){var b=a;def[b]=DS[b].shorthand!==!1?function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];return c.unshift(def.n),DS[b].apply(DS,c)}:function(){for(var a=arguments.length,c=Array(a),d=0;a>d;d++)c[d]=arguments[d];return DS[b].apply(DS,c)}}),{v:def}}();if("object"==typeof _ret)return _ret.v}catch(err){throw $log.error(err),delete DS.definitions[definition.name],delete DS.store[definition.name],err}}};return angular.forEach(asyncMethods,function(a){return DS["expect"+a[0].toUpperCase()+a.substring(1)]=DSMockUtils.createShortMethod(a,expectations)}),angular.extend(DS,stubs),sinon.spy(DS,"defineResource"),DS}]},DSHttpAdapter=function a(){_classCallCheck(this,a);var b=[],c=[],d=[],e=[],f={},g=["create","DEL","destroy","destroyAll","find","findAll","GET","HTTP","POST","PUT","update","updateAll"];this.$get=["DSMockUtils","$rootScope",function(a,h){var i=a.MockDSAdapterExpectation,j={};angular.forEach(g,function(g){f[g]=a.mockAsync(g,"DSHttpAdapter",b,c,d,e),sinon.spy(f,g)}),this.defaults={};var k={defaults:j,expect:function(a){for(var c=arguments.length,d=Array(c>1?c-1:0),e=1;c>e;e++)d[e-1]=arguments[e];if(void 0===d[0])throw new Error("Resource not defined for expectation!");var f=new i(a,d);return b.push(f),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];f.response=b}}},flush:function(a){if(!e.length)throw new Error("No pending DSHttpAdapter requests to flush !");if(angular.isDefined(a))for(;a--;){if(!e.length)throw new Error("No more pending DSHttpAdapter requests to flush !");e.shift()()}else for(;e.length;)e.shift()();h.$digest()},when:function(a){for(var b=arguments.length,d=Array(b>1?b-1:0),e=1;b>e;e++)d[e-1]=arguments[e];if(void 0===d[0])throw new Error("Resource not defined for definition");var f=new i(a,d);return c.push(f),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];f.response=b}}},verifyNoOutstandingExpectation:function(){if(h.$digest(),b.length)throw new Error("Unsatisfied requests: "+b.join(", "))}};return angular.forEach(g,function(c){return k["expect"+c[0].toUpperCase()+c.substring(1)]=a.createShortMethod(c,b)}),angular.extend(k,f),k}]};angular.module("js-data-mocks",[]).value("version","2.0.0").service("DSMockUtils",["$q",function(a){var b=function(){function a(b,c){_classCallCheck(this,a),this.method=b,this.args=c,this.resourceName=this.args[0]}return _createClass(a,{match:{value:function(a,b){return this.method!==a?!1:this.resourceName!==b?!1:!0}},matchArgs:{value:function(a){if(0===this.args.length)return!0;for(var b=!1,c=0;c<this.args.length&&(b=angular.equals(this.args[c],a[c]),b);c++);return b}}}),a}(),c=function(){function a(b,c){_classCallCheck(this,a),this.method=b,this.args=c}return _createClass(a,{match:{value:function(a){return this.method===a}},matchArgs:{value:function(a){if(0===this.args.length)return!0;for(var b=!1,c=0;c<this.args.length&&(b=angular.equals(this.args[c],a[c]),b);c++);return b}}}),a}();return{MockDSExpectation:b,MockDSAdapterExpectation:c,prettyPrint:function(a){return angular.isString(a)||angular.isFunction(a)?a:angular.toJson(a)},createResponse:function(a,b,c){return function(){return c[0]instanceof Error?b.reject.apply(null,c):b.resolve.apply(null,c)}},mockAsync:function(b,c,d,e,f,g){var h=this;return function(){for(var f=arguments.length,i=Array(f),j=0;f>j;j++)i[j]=arguments[j];var k=d[0],l=a.defer(),m=i[0];if(k&&k.match(b,m)){if(d.shift(),!k.matchArgs(i))throw new Error("Expected "+k+" with different args\nEXPECTED: "+h.prettyPrint(k.args)+"\nGOT:      "+h.prettyPrint(i));if(k.response)return g.push(h.createResponse(m,l,k.response)),l.promise;throw new Error("No response defined for "+c+"."+k.method)}for(var n=0;n<e.length;n++){var o=e[n];if(o.match(b,m)){if(o.response)return g.push(h.createResponse(m,l,o.response)),l.promise;throw new Error("No response defined!")}}throw new Error("Unexpected request: "+c+"."+b+" "+m+"\nNo more requests expected")}},createShortMethod:function(a,c){return function(){for(var d=arguments.length,e=Array(d),f=0;d>f;f++)e[f]=arguments[f];if(void 0===e[0])throw new Error("Resource not defined for expectation!");var g=new b(a,e);return c.push(g),{respond:function(){for(var a=arguments.length,b=Array(a),c=0;a>c;c++)b[c]=arguments[c];g.response=b}}}}}}]).provider("DS",DS).provider("DSHttpAdapter",DSHttpAdapter),module.exports="js-data-mocks"},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_1__){var b=new Error('Cannot find module "sinon"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_1__},function(a){if("undefined"==typeof __WEBPACK_EXTERNAL_MODULE_2__){var b=new Error('Cannot find module "angular"');throw b.code="MODULE_NOT_FOUND",b}a.exports=__WEBPACK_EXTERNAL_MODULE_2__}])});